[
  {
    "id": "d5d8611a-4892-49b1-891d-41bda012f57f",
    "name": "Навык с циклом и преобразованием",
    "description": "Текст → массив → итерации → регистр → LLM",
    "startStepId": "d78c3778-19b6-4eb4-b12e-543daff0c62a",
    "steps": [
      {
        "id": "d78c3778-19b6-4eb4-b12e-543daff0c62a",
        "name": "Ввод текста",
        "type": "code",
        "inputs": [
          {
            "name": "text",
            "type": "string",
            "schema": {
              "type": "string",
              "title": "Введённый текст"
            }
          }
        ],
        "outputs": [
          {
            "name": "text",
            "type": "string",
            "schema": {
              "type": "string",
              "title": "Введённый текст"
            }
          }
        ],
        "config": {
          "defaultText": "Пример"
        },
        "configSchema": {
          "type": "object",
          "properties": {
            "defaultText": {
              "type": "string",
              "title": "Текст по умолчанию"
            }
          }
        },
        "code": {
          "language": "javascript",
          "sourceCode": "return { text: config.defaultText };"
        }
      },
      {
        "id": "d1569dda-6f08-4a5f-a90d-1bbdb034df26",
        "name": "Текст → Массив",
        "type": "code",
        "inputs": [
          {
            "name": "text",
            "type": "string",
            "schema": {
              "type": "string"
            }
          }
        ],
        "outputs": [
          {
            "name": "items",
            "type": "array",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        ],
        "config": {},
        "code": {
          "language": "javascript",
          "sourceCode": "return { items: [text] };"
        }
      },
      {
        "id": "c8ab4cbf-305b-4533-9315-1cbbfaf2cff8",
        "name": "Цикл по массиву (итерации через шаг)",
        "type": "loop",
        "inputs": [
          {
            "name": "items",
            "type": "array",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        ],
        "outputs": [
          {
            "name": "item",
            "type": "array"
          },
          {
            "name": "done",
            "type": "array",
            "schema": {
              "type": "array",
              "items": {}
            }
          }
        ],
        "config": {
          "itemVar": "text",
          "resultVar": "upperText",
          "bodyStepId": "369c3917-8002-415c-b527-08d48916bee4"
        },
        "configSchema": {
          "type": "object",
          "properties": {
            "itemVar": {
              "type": "string",
              "title": "Имя переменной для итерации",
              "default": "item"
            },
            "resultVar": {
              "type": "string",
              "title": "Ключ для сбора результата",
              "default": "result"
            },
            "bodyStepId": {
              "type": "string",
              "title": "Шаг, вызываемый на каждой итерации"
            }
          },
          "required": [
            "itemVar",
            "resultVar",
            "bodyStepId"
          ]
        }
      },
      {
        "id": "369c3917-8002-415c-b527-08d48916bee4",
        "name": "К верхнему регистру",
        "type": "code",
        "inputs": [
          {
            "name": "text",
            "type": "string",
            "schema": {
              "type": "string"
            }
          }
        ],
        "outputs": [
          {
            "name": "upperText",
            "type": "string",
            "schema": {
              "type": "string"
            }
          }
        ],
        "config": {},
        "configSchema": {
          "type": "object",
          "properties": {}
        },
        "code": {
          "language": "javascript",
          "sourceCode": "return { upperText: text.toUpperCase() };"
        }
      },
      {
        "id": "fbc4cb43-974d-486a-8354-0eb883b9774a",
        "name": "LLM вызов",
        "type": "code",
        "description": "Отправляет текст в LLM и возвращает ответ",
        "inputs": [
          {
            "name": "prompt",
            "type": "string",
            "schema": {
              "type": "string",
              "title": "Промпт"
            }
          }
        ],
        "outputs": [
          {
            "name": "completion",
            "type": "string",
            "schema": {
              "type": "string",
              "title": "Ответ модели"
            }
          }
        ],
        "config": {
          "apiKey": "sk-to8ADu5fQYxpAd_BOcshlOCeuXHlWVTVGkCc_OzjdIT3BlbkFJKP-xTU231BP1-2N5fWGnl5xT4EM6XPr6if-VKpUL8A",
          "model": "gpt-3.5-turbo"
        },
        "configSchema": {
          "type": "object",
          "properties": {
            "apiKey": {
              "type": "string",
              "title": "API ключ OpenAI"
            },
            "model": {
              "type": "string",
              "title": "ID модели"
            }
          },
          "required": [
            "apiKey",
            "model"
          ]
        },
        "code": {
          "language": "javascript",
          "sourceCode": "const response = await fetch('https://api.openai.com/v1/chat/completions', { method: 'POST',  headers: { 'Authorization': 'Bearer ' + config.apiKey,  'Content-Type': 'application/json'  }, body: JSON.stringify({    model: config.model,  messages: [{ role: 'user', content: prompt }]})});const data = await response.json();console.log('data',data) ;if (data?.error?.message){throw new Error(data?.error?.message)} return { completion: data.choices?.[0].message.content ||'qq' };"
        }
      }
    ],
    "links": [
      {
        "id": "452c64ef-341e-4282-acee-4bec81cc486b",
        "fromStepId": "d78c3778-19b6-4eb4-b12e-543daff0c62a",
        "fromPort": "text",
        "toStepId": "d1569dda-6f08-4a5f-a90d-1bbdb034df26",
        "toPort": "text"
      },
      {
        "id": "3afda7bd-ee85-4817-a5fe-a1355af9cda0",
        "fromStepId": "d1569dda-6f08-4a5f-a90d-1bbdb034df26",
        "fromPort": "items",
        "toStepId": "c8ab4cbf-305b-4533-9315-1cbbfaf2cff8",
        "toPort": "items"
      },
      {
        "id": "bc68e8be-48b4-4935-ba58-719f3b61a8f5",
        "fromStepId": "c8ab4cbf-305b-4533-9315-1cbbfaf2cff8",
        "fromPort": "item",
        "toStepId": "369c3917-8002-415c-b527-08d48916bee4",
        "toPort": "text"
      },
      {
        "id": "a5e44df8-473f-406a-97a9-d445b446da47",
        "fromStepId": "c8ab4cbf-305b-4533-9315-1cbbfaf2cff8",
        "fromPort": "done",
        "toStepId": "fbc4cb43-974d-486a-8354-0eb883b9774a",
        "toPort": "prompt"
      }
    ]
  }
]